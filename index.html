<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Realtime Button Counter + History + CSV</title>

  <!-- Firebase compat SDKs for Realtime DB -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>

  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: 40px auto; }
    button { padding: 10px 18px; margin: 10px; font-size: 16px; }
    table { width: 100%; border-collapse: collapse; margin-top: 30px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background: #eee; }
  </style>
</head>
<body>

<h1>Global Button Counter (Realtime DB)</h1>

<div>
  <button onclick="recordClick('button1')">Button 1</button>
  <span id="count_button1">0</span>
</div>

<div>
  <button onclick="recordClick('button2')">Button 2</button>
  <span id="count_button2">0</span>
</div>

<div>
  <button onclick="recordClick('button3')">Button 3</button>
  <span id="count_button3">0</span>
</div>

<h2>Click History</h2>
<button onclick="exportCSV()">Export as CSV</button>

<table id="historyTable">
  <thead>
    <tr>
      <th>Timestamp</th>
      <th>Button</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
  // --- INSERT YOUR FIREBASE CONFIG HERE ---
  const firebaseConfig = {
    apiKey: "AIzaSyAIyugMsDbtGBzNcrDQgUzrQxMIQAqgVO4",
      authDomain: "global-button-counter-7ffa6.firebaseapp.com",
      databaseURL: "https://global-button-counter-7ffa6-default-rtdb.firebaseio.com",
      projectId: "global-button-counter-7ffa6",
      storageBucket: "global-button-counter-7ffa6.firebasestorage.app",
      messagingSenderId: "779296250516",
      appId: "1:779296250516:web:23999491482b288aebb281",
      measurementId: "G-FYYENFEG3Q",
  };
  // -----------------------------------------

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const countersRef = db.ref("counters");
  const historyRef = db.ref("history");

  // Ensure counters exist
  countersRef.once("value", snap => {
    if (!snap.exists()) {
      countersRef.set({
        button1: 0,
        button2: 0,
        button3: 0
      });
    }
  });

  // Record a click
  function recordClick(buttonName) {
    // 1) increment counter
    countersRef.child(buttonName).transaction(current => {
      return (current || 0) + 1;
    });

    // 2) add history record
    historyRef.push({
      button: buttonName,
      timestamp: Date.now()
    });
  }

  // Real-time counter updates
  countersRef.on("value", snap => {
    const data = snap.val() || {};
    document.getElementById("count_button1").textContent = data.button1 || 0;
    document.getElementById("count_button2").textContent = data.button2 || 0;
    document.getElementById("count_button3").textContent = data.button3 || 0;
  });

  // Real-time history table updates
  historyRef.limitToLast(500).on("value", snap => {
    const tbody = document.querySelector("#histor
